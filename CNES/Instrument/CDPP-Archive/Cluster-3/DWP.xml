<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Spase xmlns="http://www.spase-group.org/data/schema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.spase-group.org/data/schema http://www.spase-group.org/data/schema/spase-2_4_0.xsd">
  <Version>2.4.0</Version>
  <Instrument>
    <ResourceID>spase://CNES/Instrument/CDPP-Archive/Cluster-3/DWP</ResourceID>
    <ResourceHeader>
      <ResourceName>Digital Wave Processor (DWP)</ResourceName>
      <ReleaseDate>2019-05-05T12:34:56Z</ReleaseDate>
      <Description>The Digital Wave Processing Experiment, DWP, is a component of the Wave Experiment Consortium (WEC). The wide variety of geophysical plasmas that will be investigated by the Cluster mission contain waves with a frequency range from DC to over 100 kHz with both magnetic and electric components. The characteristic duration of these waves extends from a few milliseconds to minutes and a dynamic range of over 90 dB is desired. All of these factors make it essential that the onboard control system for the WEC instruments be flexible so as to make effective use of the limited spacecraft resources of power and telemetry. The DWP instrument employs a novel architecture based on the use of transputers with parallel processing and re-allocatable tasks to provide a high-reliability flexible system.
DWP is responsible for coordinating WEC operations at several levels. At the lowest level, DWP provides electrical signals to synchronise instrument sampling. At higher levels, DWP time tags data in a consistent manner and provides a facility for constructing more complex WEC modes by means of macros.
The processing system within the DWP instrument will also perform particle correlations in order to permit the study of wave/particle interactions. Particle correlation is based on forming autocorrelation functions of the time series of particle detector counts as a function of energy and pitch angle. The basic operations are carried out in DWP resident software using algorithms developed for AMPTE, CRRES, rocket experiments and also from computer simulations.
The DWP particle correlator takes raw electron detection pulses from the PEACE instrument and performs software Auto-Correlation Functions (ACF) that are sorted and summed according to instantaneous PEACE selected electron energy.
The energy level range is partitioned into 15 contiguous energy bins irrespective of the PEACE energy sweeping rate. ACFs have 8 lags including zero lag. As the lag time is 45 µs this corresponds to modulation frequencies up to 11.1 kHz with only low, 1.4 kHz, resolution.
The basic summation period is one spin at normal rate, and 1/32 spin at high data rate. The data rate is limited to transmitting the summed ACF at two selected energies per summation period, plus a third ACF that is stepped in energy once per summation period, through the other 13 levels. Thus in normal mode two selected energies are covered with a time resolution of 4 s, while other energies have a time resolution of 52 s. In high data rate these periods are 0.125 s and 1.625 s, respectively. Note that in normal mode the data corresponds to a range of electron pitch angles, being summed over spins. Assuming that the analysed zone includes the direction parallel to the magnetic field, B, then this range in pitch angle is in general, 0° to an angle twice that between the spin axis and the Earth's magnetic field direction. Thus operation in high data rate will be needed to provide the pitch angle dependence of particle modulations. The low data rate mode will obviously operate best when the spin axis is close to B.
The particle correlator technique permits the detection of particle flux bursts on time scales short compared with the energy and dwell time and an indication of regions of velocity space in which wave/particle interactions are occurring.
Data-compression techniques are employed in the DWP instrument to optimise the use of available telemetry, a problem particularly severe for wave experiments. This allows more useful information to be transmitted over a given telemetry system than would otherwise be possible and is achieved by removing redundant information from the data. Various data compression methods are implemented within the WEC and DWP. To simplify allocation of telemetry bandwidth, these are restricted to methods providing a fixed degree of compression independent of the variability of the data. The methods are:
-   Wideband instrument (WBD)--digital filtering with resampling
-   STAFF Search Coil (MWF)--differential encoding
-   WHISPER--data selection followed by pseudo-logarithmic compression, and
-   Correlator--averaging.
The design of the DWP permits the transputers to be operated at input clock frequencies of 2.5 or 5 MHz, the lower rate requiring less power. Speed selection is made by hardware command from the OBDH.
A variety of interfaces are used to control and obtain data from the instruments of the wave consortium. Interfaces with a relatively low data rate employ registers allocated one of the 16 instrument bus addresses and in some cases an event request line. High-data-rate interfaces use DMA channels.
The peak loading on the kernel processor for transferring data will be about 50%. The average load will be at most half this figure. This leaves time for the other tasks the kernel has to perform.
Wideband data (WBD) has direct connections to the spacecraft data handling system and this is the path that is usually used for data transmission. Unlike the other WEC instruments, sampling and output are not controlled by DWP. It is however, commanded by DWP. WBD data may also be routed to one of the two spacecraft tape recorders through the DWP interface to the spacecraft. To reduce the bit-rate to fit within the WEC science telemetry allocation, DWP reduces the data rate by a factor of three by applying a digital filtering algorithm to this data stream and then resampling it.
DWP time-stamps the WEC data with a time tag relative to the spacecraft onboard time. DWP has an internal clock running at a fixed frequency of 900 Hz. Pulses of this clock are counted by software which derives either a 25 Hz or a 450 Hz signal known as the WEC Sample Sync. (WECSS). This controls STAFF Magnetic Waveform Analyser (MWF) and EFW electric field sampling and ensures that sample taking is synchronised to this clock. The WECSS is not synchronous with the spacecraft's spin rate.
DWP has direct digital control of STAFF MWF by means of a number of control signals that enable DWP to select the Bx, By or Bz field components and to control the ADC. DWP reads values of Bx, By, and Bz to 16-bit resolution at the frequency of WECSS and assembles the values in a buffer within DWP. By contrast, EFW has its own microprocessor that fills a sampling buffer within EFW and, one per second, outputs a data packet to DWP through a serial interface (uart). To facilitate time correlation of EFW and STAFF MWF data, DWP samples one second's worth of MWF data before outputting it to the spacecraft. Furthermore, DWP controls the start of EFW sampling (by means of the transmission of a synchronisation character) so that EFW and MWF sampling start at the same time and both generate a complete packet of data one second later. DWP ensures that both of these packets carry the same time tag so as to aid subsequent correlative studies.
It can be seen that for EFW and STAFF operations there is a one-second period where sample buffers are being filled before they are output. DWP delays any telecommanded mode changes for EFW and MWF until the sample buffers have been flushed of the samples taken during the last second. This point is termed the One Second timing Boundary (OSTB), and all WEC instrument mode changes are synchronised to OSTBs to ensure continuous time coverage in known instrument modes.
STAFF and EFW data are stamped with the time of the OSTB at the start of the sampling period. This facilitates time correlation between data from these instruments. WBD and WHISPER data are stamped with the time at which the data packet was received by DWP. From this, and from an understanding of the internal timing within the instrument, it is possible to determine when the samples were actually taken.
An area of DWP memory is allocated as a buffer for WEC macros. The WEC macro buffer can hold a number of command sequences that can be invoked with a single telecommand from the spacecraft. The WEC macros exist for two main reasons:
1.    the number of telecommands that can be uplinked to the spacecraft in any orbit is limited. By storing the most commonly used sequences of commands in the macro-buffer, efficient use can be made of the spacecraft telecommanding allocation
2.    commands can be inserted into the macro buffer to enable features such as looping and timed delays to implement automatic WEC instrument mode switching. These permit the construction of more scientifically interesting WEC modes.    
To summarise, the WEC macros provide a skeleton for each WEC mode which can be adjusted by additional telecommands transmitted from the spacecraft as may be required for any particular campaign. 
This description has been obtained from Section 3.5 of the Users Guide to the Cluster Science Data System, DS-MPA-TN-0015.</Description>
      <Contact>
        <PersonID>spase://CNES/Person/CDPP-Archive/Hugo.Alleyne</PersonID>
        <Role>PrincipalInvestigator</Role>
      </Contact>
    </ResourceHeader>
    <InstrumentType>Unspecified</InstrumentType>
    <InvestigationName>Digital Wave Processor (DWP) on Cluster-3</InvestigationName>
    <ObservatoryID>spase://CNES/Observatory/CDPP-Archive/Cluster-3</ObservatoryID>
  </Instrument>
</Spase>
